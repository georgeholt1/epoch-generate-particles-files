# EPOCH Generate Particles Files

A Python utility for generating custom particle position data for use with the particle-in-cell code [EPOCH](https://github.com/Warwick-Plasma/epoch).

## Installation
Clone this repository or download and extract.

## Usage
In a nutshell:
1. Define a Python function in the relevant file within the distributions directory that describes a particle number density distribution.
2. Run `main.py` with the applicable arguments (see below).
3. Feed the generated particle data into EPOCH.

### Defining a density distribution
The density distribution can be described by any Python function that returns a value of number density (in SI units) for a given spatial coordinate.

The function should be defined in the `distributions` directory in the file `dX.py`, where `X` is the spatial dimensionality of the simulation to be run. The function should be named `number_density_Xd` (where again, `X` is the dimensionality), take `X` parameters (the spatial coordinates), and return a value of number density.

Example functions are included for 1, 2 and 3 dimensions.

### Running the tool
Once the density distribution has been defined, the particle data is generated by running the `main.py` file and supplying necessary arguments. For example:

```python main.py -d 1 -o test --xmin=-3e-6 --xmax=2e-6 --nx 300 --ppc 8 --plot --nmin=0.05e25 --progress```

will generate 1-dimensional particle data in the region `[-3e-6 m, 2e-6 m]`, with 300 cells in the domain and 8 macroparticles per cell. Only particles that are in a region with number density greater than 0.05e25 per cubic metre are generated. The data and a plot are saved to the directory `test` (which must exist). A progress bar will be printed (which will probably be too fast to see in this case, but can be useful for higher resolution and/or dimensionality).

Notice that arguments with numerical values given in scientific units (e.g. `2e-6`) are specified with an `=` sign. The arguments will not parse correctly otherwise.

To see a full, commented list of possible arguments, run:

```python main.py --help```

### Pass the particle data to EPOCH
See the EPOCH user manual for a description of how to use simple binary files (section 3.7 and appendix B of the manual v4.17). As an example, the following is an excerpt of an input deck for a 1D simulation using the particle data generated by this tool:

```
begin:species

    name = electron
    charge = -1.0
    mass = 1.0

end:species

begin:particles_from_file

    species = electron
    x_data = "xdata.dat"
    w_data = "wdata.dat"

end:particles_from_file
```

### Current limitations
- Only cold, zero-momentum particle distributions can be generated.
- The space can only be sampled randomly.
- 3D density distribution are not visualised.

## Requirements
- Python 3 (tested with v3.7.4) with [matplotlib](https://matplotlib.org/) (tested with v3.1.3), [numpy](https://numpy.org/) (tested with v1.17.2).
- Optional: [tqdm](https://pypi.org/project/tqdm/).

## License
[MIT](https://choosealicense.com/licenses/mit/)